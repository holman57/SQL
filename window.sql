SELECT 
    MIN(Z) OVER W AS MIN_Z,
    MAX(Z) OVER W AS MAX_Z
FROM Table
WINDOW W AS (
    PARTION BY X
    ORDER BY Y
    ROWS BETWEEN UNBOUNDED PRECEDING
        AND CURRENT ROW
);

